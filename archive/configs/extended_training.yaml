# LayeredInterpolator Extended Training Configuration
# ===================================================
# Full dataset + longer training for maximum quality
# 
# Usage: py -3.11 -m ainimotion.training.train --config configs/extended_training.yaml --data "D:\Triplets" --auto-resume

# Model Architecture
base_channels: 32
kernel_size: 7
grid_size: 8
use_refinement: true

# Discriminator
disc_channels: 64

# Training - EXTENDED
epochs: 100              # 2x longer training
batch_size: 12
num_workers: 12
crop_size: [256, 256]
prefetch_factor: 4
persistent_workers: true
max_samples: null        # USE ALL 610K TRIPLETS (no limit)

# Learning rates
lr_g: 0.0001
lr_d: 0.00002
weight_decay: 0.01

# Loss weights
l1_weight: 1.0
perceptual_weight: 0.1
edge_weight: 0.5
gan_weight: 0.1

# GAN configuration
gan_type: lsgan

# Adaptive training
label_smoothing: 0.15
d_throttle_threshold: 0.85
d_throttle_patience: 50

# Early stopping - more patient for longer training
early_stop_patience: 15   # Wait longer before stopping
min_psnr_delta: 0.15      # Slightly lower threshold

# Mixed precision
use_amp: true
cudnn_benchmark: true

# Logging and checkpointing
log_dir: runs
checkpoint_dir: checkpoints
save_every: 1
save_every_batches: 2000  # Less frequent saves (larger dataset)

# Data
data_dir: D:\Triplets
